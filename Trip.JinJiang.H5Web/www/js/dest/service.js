angular.module("starter.service",[]).service("filtbydaysev",function(){this.filtfunc=function(a,b,c,d,e,f,g){var h=c.split("|"),i=d.split("|"),j="../../ajax/apihandler.ashx?fn=getlinesbycategory&businessCategory="+e.category+"&keyWord="+e.keyWord,k=layer.load(1,{shade:[.5,"#ababab"]});a.get(j).success(function(j){var l=j,m="../../ajax/apihandler.ashx?fn="+e.fn+"&category="+e.category;a.get(m).success(function(a){layer.close(k);for(var e=a,j=new Array(0),m=function(){(void 0===l.lines[o].imageUrls[0]||null===l.lines[o].imageUrls[0]||l.lines[o].imageUrls[0].indexOf("http")<0)&&(l.lines[o].imageUrls[0]="http://img5.imgtn.bdimg.com/it/u=45254662,160915219&fm=21&gp=0.jpg"),l.lines[o].lineCategory=e.lines[n].lineCategory,j.push(l.lines[o])},n=0;n<e.lines.length;n++)for(var o=0;o<l.lines.length;o++)"day"!=g&&g?"ag"==g&&(i[1]?e.lines[n].lineId==l.lines[o].lineId&&d.indexOf("|"+l.lines[o].agency+"|")>-1&&(h[1]&&c.indexOf("|"+l.lines[o].days+"|")>-1?m():h[1]||m()):e.lines[n].lineId==l.lines[o].lineId&&m()):h[1]?e.lines[n].lineId==l.lines[o].lineId&&c.indexOf("|"+l.lines[o].days+"|")>-1&&(i[1]&&d.indexOf("|"+l.lines[o].agency+"|")>-1?m():i[1]||m()):e.lines[n].lineId==l.lines[o].lineId&&m();b.agencies=l.agencies,b.linelists=j.sort(objectorderby("point")),f(j.length)})})},this.getdays=function(a,b,c,d){var e=layer.load(1,{shade:[.5,"#ababab"]}),f="../../ajax/apihandler.ashx?fn=getlinesbycategory&businessCategory="+d.category+"&keyWord="+d.keyWord;a.get(f).success(function(a){layer.close(e),c(a.days.sort(sortbyday0))})},this.getagencies=function(a,b,c,d){var e=layer.load(1,{shade:[.5,"#ababab"]}),f="../../ajax/apihandler.ashx?fn=getlinesbycategory&businessCategory="+d.category+"&keyWord="+d.keyWord;a.get(f).success(function(a){layer.close(e),c(a.agencies)})}}).service("getbindquerysev",function(){this.bindquetyfunc=function(a,b){var c=getCookie("mcMemberCode"),d="../../ajax/payhandler.ashx?fn=bindcardquery&memberid="+c,e=layer.load(1,{shade:[.5,"#ababab"]});a.get(d).success(function(a){if(layer.close(e),a){var c=(new X2JS).xml_str2json(a);b(c)}})}});