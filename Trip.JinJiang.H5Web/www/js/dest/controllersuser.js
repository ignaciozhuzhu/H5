function myfocus(a){""==$(a)[0].value&&($(a)[0].previousElementSibling.className="item-tip item-tip-focus",$(a)[0].className="form-input form-input-focus")}function myblur(a){""==$(a)[0].value&&($(a)[0].previousElementSibling.className="item-tip",$(a)[0].className="form-input")}function myfocust(a){a=a.nextElementSibling,""==$(a)[0].value&&($(a)[0].previousElementSibling.className="item-tip item-tip-focus",$(a)[0].className="form-input form-input-focus")}function myblurt(a){a=a.nextElementSibling,""==$(a)[0].value&&($(a)[0].previousElementSibling.className="item-tip",$(a)[0].className="form-input")}function settypepng(){for(var a=0;a<$(".seebutton .cancel").length;a++)$(".seebutton .cancel")[a].parentNode.previousElementSibling.previousElementSibling.innerText.indexOf("已取消")>-1&&($(".seebutton .cancel")[a].className="seebutton cancel displaynone",$(".seebutton .payy")[a].className="seebutton payy displaynone"),$(".seebutton .cancel")[a].parentNode.previousElementSibling.previousElementSibling.innerText.indexOf("已支付")>-1&&($(".seebutton .payy")[a].className="seebutton payy displaynone")}angular.module("starter.controllersuser",[]).controller("registerCtrl",["$scope","$http",function(a,b){nofollowfunc();var c,d,e;a.regist=function(){for(var a=$(".register #password")[0].value,c=hex_md5(a),e=hex_sha1(a),f=$(".register #certificateType")[0].value,g=$(".register #certificateNo")[0].value,h=$(".register #email")[0].value,i=$(".register #phone")[0].value,j=$("input[name='Sex'][checked]").val(),k=$(".register #surname")[0].value,l=document.getElementsByName("Sex"),m=0;m<l.length;m++)l[m].checked&&(j=l[m].value);if(""===$(".register #phone")[0].value)return void layermyui("请输入手机号");if(""===$(".register #email")[0].value)return void layermyui("请输入邮箱");if(!checkMobile($(".register #phone")[0].value))return void layermyui("手机号格式不正确");if(!isEmail($(".register #email")[0].value))return void layermyui("邮箱格式不正确");if(""===$(".register #password")[0].value)return void layermyui("请输入密码");if(!isPassword($(".register #password")[0].value))return void layermyui("密码过于简单,不能少于六位数");if(""===$(".register #password2")[0].value)return void layermyui("请输入确认密码");if($(".register #password2")[0].value!==$(".register #password")[0].value)return void layermyui("两次密码不一致");if(""===k)return void layermyui("请输入姓名");if(""===g)return void layermyui("请输入证件号");if(!isIdCardNo(g))return void layermyui("证件号不对");if(""==j||void 0==j||null==j)return void layermyui("请选择称谓");f="ID";var n="<memberRegisterDto><memberInfoDto>";n+="<memberType>Silver Card</memberType>",n+="<certificateNo>"+g+"</certificateNo>",n+="<certificateType>"+f+"</certificateType>",n+="<email>"+h+"</email>",n+="<mobile>"+i+"</mobile>",n+="<scoreType>1</scoreType>",n+="<title>"+j+"</title>",n+="<surname>"+k+"</surname>",n+="<memberScoreType>SCORE</memberScoreType>",n+="<registerSource>Website</registerSource>",n+="<passsword>"+c+"</passsword>",n+="<sha1pwd>"+e+"</sha1pwd>",n+="<ipAddress>"+d+"</ipAddress>",n+="</memberInfoDto></memberRegisterDto>";var o="../../ajax/userHandler.ashx?fn=regist&xml="+n,p=layer.load(1,{shade:[.5,"#ababab"]});b.get(o).success(function(a){find404admin(a),layer.close(p);var b=new X2JS,c=a,d=b.xml_str2json(c);if("00001"==d.crmResponseDto.retcode){var e=getCookie("tolamount"),f=getCookie("cnum"),g=getCookie("pnum"),h=getCookie("groupid"),j=getCookie("secureamount");setCookie("mcMemberCode",d.crmResponseDto.mcMemberCode,1),setCookie("phonenum",i,1),h>0?(layermyui("注册成功!将自动为您跳转..."),window.location.href="#/app/payway/"+j+"/"+h+"/"+g+"/"+f+"/"+e):(layermyui("注册成功!将自动为您跳转回首页..."),window.location.href="#/app/index")}else layermyui(d.crmResponseDto.retmsg)})},a.$on("$ionicView.loaded",function(){getIPs2(function(a){var b=document.createElement("li");b.textContent=a,a.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/)?(document.getElementsByTagName("ul")[0].appendChild(b),c=a):a.match(/^[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}$/)?(e=a,document.getElementsByTagName("ul")[2].appendChild(b)):(d=a,document.getElementsByTagName("ul")[1].appendChild(b))})})}]).controller("loginCtrl",["$scope","$http",function(a,b){nofollowfunc(),a.login=function(){var a=$(".login #loginname")[0].value,c=$(".login #password")[0].value,d=hex_md5(c),e=hex_sha1(c);if(!a)return void layermyui("请输入手机号/邮箱");if(!c)return void layermyui("请输入密码");var f="<mergeLoginDto>";f+="<loginName>"+a+"</loginName>",f+="<md5>"+d+"</md5>",f+="<sha1>"+e+"</sha1>",f+="</mergeLoginDto>";var g="../../ajax/userHandler.ashx?fn=login&xml="+f,h=layer.load(1,{shade:[.5,"#ababab"]});b.get(g).success(function(b){find404admin(b),layer.close(h);var c=new X2JS,d=b,e=c.xml_str2json(d);if("登录成功"===e.memberMergeDto.remark){var f=getCookie("tolamount"),g=getCookie("cnum"),i=getCookie("pnum"),j=getCookie("groupid"),k=0;setCookie("mcMemberCode",e.memberMergeDto.mcMemberCode,1),setCookie("fullName",e.memberMergeDto.fullName,1),setCookie("phonenum",a,1),layermyui("登录成功!");var l=getCookie("mcMemberCode"),m=getCookie("linkbackpay");if(""!==l&&void 0!==l&&null!==l){$("#account").empty().append("退出登录");var n=getCookie("fullName");$("#myinfofullName").empty().append(n),$("#account").css({display:"block"})}j>0&&"true"===m?(setCookie("linkbackpay","",1),window.location.href="#/app/fillorder/"+k+"/"+j+"/"+i+"/"+g+"/"+f):window.location.href="#/app/index"}else layermyui(e.memberMergeDto.remark)})},a.backhist=function(){window.history.back()}}]).controller("quickregisterCtrl",["$scope","$http",function(a,b){nofollowfunc(),a.regist=function(){var a=$(".quickregister #password")[0].value,c=hex_md5(a),d=hex_sha1(a),e=$(".quickregister #email")[0].value,f=$(".quickregister #phone")[0].value;if(""===$(".quickregister #phone")[0].value)return void layermyui("请输入手机号");if(""===$(".quickregister #email")[0].value)return void layermyui("请输入邮箱");if(!checkMobile($(".quickregister #phone")[0].value))return void layermyui("手机号格式不正确");if(!isEmail($(".quickregister #email")[0].value))return void layermyui("邮箱格式不正确");if(""===$(".quickregister #password")[0].value)return void layermyui("请输入密码");if(!isPassword($(".quickregister #password")[0].value))return void layermyui("密码过于简单,不能少于六位数");if(""===$(".quickregister #password2")[0].value)return void layermyui("请输入确认密码");if($(".quickregister #password2")[0].value!==$(".quickregister #password")[0].value)return void layermyui("两次密码不一致");var g="<webMemberDto>";g+="<email>"+e+"</email>",g+="<phone>"+f+"</phone>",g+="<pwd>"+c+"</pwd>",g+="<sha1pwd>"+d+"</sha1pwd>",g+="<registChannel>Website</registChannel>",g+="<registTag>IOS|JJTRAVEL_IOS_1|JinJiang</registTag>",g+="</webMemberDto>";var h="../../ajax/userHandler.ashx?fn=quickregist&xml="+g,i=layer.load(1,{shade:[.5,"#ababab"]});b.get(h).success(function(a){find404admin(a),layer.close(i);var b,c=new X2JS,d=a,e=c.xml_str2json(d);try{b=e.webMemberRegisterReturnDto.mcMemberCode}catch(g){b=""}if(""===b||void 0===b)return void layermyui(e.webMemberRegisterReturnDto.message);var h=getCookie("tolamount"),j=getCookie("cnum"),k=getCookie("pnum"),l=getCookie("groupid"),m=getCookie("secureamount");setCookie("mcMemberCode",e.webMemberRegisterReturnDto.mcMemberCode,1),setCookie("phonenum",f,1),layermyui("注册成功!将自动为您跳转回支付页面..."),l>0?window.location.href="#/app/payway/"+m+"/"+l+"/"+k+"/"+j+"/"+h:window.location.href="#/app/index"})}}]).controller("forgetpwdCtrl",["$scope","$http",function(a,b){nofollowfunc(),a.forgetpwd=function(){if(""===$(".forgetpwd0 #name")[0].value)return void layermyui("请输入姓名");if(""===$(".forgetpwd0 #phone")[0].value)return void layermyui("请输入手机");if(""===$(".forgetpwd0 #code")[0].value)return void layermyui("请输入验证码");if(!isPassword($(".forgetpwd0 #newpwd")[0].value))return void layermyui("密码过于简单,不能少于六位数");var a=$(".forgetpwd0 #code")[0].value,c=$(".forgetpwd0 #phone")[0].value,d=$(".forgetpwd0 #name")[0].value,e=hex_md5($(".forgetpwd0 #newpwd")[0].value),f=hex_sha1($(".forgetpwd0 #newpwd")[0].value),g="../../ajax/userHandler.ashx?fn=forgetpwd";g+="&validateCode="+a,g+="&loginName="+c,g+="&fullName="+d,g+="&md5="+e,g+="&sha1="+f;var h=layer.load(1,{shade:[.5,"#ababab"]});b.get(g).success(function(a){find404admin(a),layer.close(h);var b=new X2JS,c=a,d=b.xml_str2json(c);return"success"===d.memberBaseDto.rtcode?(layermyui("密码修改完成,<br>将跳转至登录页面",3e3),void window.setTimeout("window.location='#/app/user/login'",3e3)):void layermyui("修改失败,请检查.")})}}]).controller("myorderCtrl",["$scope","$http","$ionicScrollDelegate","$ionicHistory",function($scope,$http,$ionicScrollDelegate,$ionicHistory){function getorders(a){var b=layer.load(1,{shade:[.5,"#ababab"]});$http.get(a,{cache:!1}).success(function(a){layer.close(b),find404admin(a),$scope.orders=a.orders;for(var c=0;c<a.orders.length;c++)a.orders[c].paymentAmount?$scope.orders[c].discountafterAmount=a.orders[c].paymentAmount:a.orders[c].paymentAmount||"已支付"==a.orders[c].payStatusName||($scope.orders[c].discountafterAmount=a.orders[c].amount,$scope.orders[c].orderStatusName="待确认-门店支付","CANCELED"==$scope.orders[c].orderStatus&&($scope.orders[c].orderStatusName="已取消")),"已支付"==$scope.orders[c].payStatusName&&($scope.orders[c].orderStatusName="已支付"),"待支付"==$scope.orders[c].payStatusName&&($scope.orders[c].orderStatusName="待支付"),"待支付"==$scope.orders[c].payStatusName&&"CANCELED"==$scope.orders[c].orderStatus&&($scope.orders[c].orderStatusName="已取消");setTimeout(settypepng,0)})}function addclassyellow(a){$(".header0 div:eq("+a+")").css("color","#f59609")}function removeclassyellow(a){$(".header0 div").css("color","#beb9c0")}nofollowfunc();var mcMemberCode=getCookie("mcMemberCode"),orderStatus="",payStatus="",a=$(".header0")[0].offsetTop;40>a?$(".header0").css({"margin-top":"35px"}):$(".header0").css({"margin-top":"0px"}),null==$ionicHistory.viewHistory().backView&&$(".header0").css({"margin-top":"0px"}),removeclassyellow(),addclassyellow(0);var nghttp="../../ajax/userHandler.ashx?fn=queryorder&mcMemberCode="+mcMemberCode+"&orderStatus="+orderStatus+"&payStatus="+payStatus;getorders(nghttp),$scope.seedetail=function(a){var b=event.currentTarget.lastElementChild.innerText;window.location.href="#/app/user/orderdetail/"+b},$scope.cancelorder=function($event){var ordercode=event.currentTarget.lastElementChild.innerText,mcMemberCode=getCookie("mcMemberCode"),paytext=event.currentTarget.parentNode.previousElementSibling.previousElementSibling.childNodes[1].children[3].innerText,paytext2=event.currentTarget.parentNode.previousElementSibling.previousElementSibling.childNodes[1].children[2].innerText;if("待支付"==paytext||"待确认-门店支付"==paytext2){var mylayeruiwait=layer.load(1,{shade:[.5,"#ababab"]});$.ajax({url:"../../ajax/userHandler.ashx?fn=cancelorder&orderCode="+ordercode+"&mcMemberCode="+mcMemberCode,type:"post",success:function(response){layer.close(mylayeruiwait);var d=eval("("+response+")");return d.errorCode?void alert(d.errorMsg):(alert("取消成功"),void location.reload())}})}else"已支付"==event.currentTarget.parentNode.previousElementSibling.previousElementSibling.childNodes[1].children[3].innerText&&layermyui("您的订单为已支付订单，需确认退款金额，请及时与客服联系，客服电话10101666*3，客服工作时间：8点至21点。")},$scope.paynow=function(){var a,b,c,d,e=event.currentTarget.lastElementChild.innerText,f="../../ajax/userHandler.ashx?fn=queryorderdetail&code="+e;layer.load(1,{shade:[.5,"#ababab"]});$http.get(f).success(function(f){find404admin(f),a=f.groupId,b=f.childNum,c=f.adultNum,d=f.paymentAmount;var g=getCookie("mcMemberCode");""!=g&&void 0!=g&&null!=g?window.location.href="#/app/payway/"+e+"/"+a+"/"+c+"/"+b+"/"+d:(setCookie("tolamount",amount,1),setCookie("cnum",b,1),setCookie("pnum",pnum,1),setCookie("groupid",a,1),setCookie("orderNo",e,1),window.location.href="#/app/user/login")})},$scope.li0=function(){$ionicScrollDelegate.$getByHandle("mainScroll").scrollTop(),removeclassyellow(),addclassyellow(0);var a="",b="",c="../../ajax/userHandler.ashx?fn=queryorder&mcMemberCode="+mcMemberCode+"&orderStatus="+a+"&payStatus="+b;getorders(c)},$scope.li1=function(){$ionicScrollDelegate.$getByHandle("mainScroll").scrollTop(),removeclassyellow(),addclassyellow(1);var a="CONFIRMED",b="PAY_WAITING",c="../../ajax/userHandler.ashx?fn=queryorder&mcMemberCode="+mcMemberCode+"&orderStatus="+a+"&payStatus="+b;getorders(c)},$scope.li2=function(){$ionicScrollDelegate.$getByHandle("mainScroll").scrollTop(),removeclassyellow(),addclassyellow(2);var a="",b="PAYED",c="../../ajax/userHandler.ashx?fn=queryorder&mcMemberCode="+mcMemberCode+"&orderStatus="+a+"&payStatus="+b;getorders(c)},$scope.li3=function(){$ionicScrollDelegate.$getByHandle("mainScroll").scrollTop(),removeclassyellow(),addclassyellow(3);var a="CANCELED",b="",c="../../ajax/userHandler.ashx?fn=queryorder&mcMemberCode="+mcMemberCode+"&orderStatus="+a+"&payStatus="+b;getorders(c)},$scope.li4=function(){$ionicScrollDelegate.$getByHandle("mainScroll").scrollTop(),removeclassyellow(),addclassyellow(4);var a="FAILED",b="",c="../../ajax/userHandler.ashx?fn=queryorder&mcMemberCode="+mcMemberCode+"&orderStatus="+a+"&payStatus="+b;getorders(c)}}]).controller("orderdetailCtrl",["$scope","$http",function(a,b){nofollowfunc();var c,d,e,f,g=getpbyurl(1),h="../../ajax/userHandler.ashx?fn=queryorderdetail&code="+g,i=layer.load(1,{shade:[.5,"#ababab"]});b.get(h).success(function(g){find404admin(g),c=g.groupId,d=g.childNum,e=g.adultNum,f=g.paymentAmount,a.status="PAYED"==g.payStatus?"已支付":"待支付","已支付"!=a.status&&"CANCELED"!=g.orderStatus||($(".orderdetail .seebutton").css("display","none"),"CANCELED"==g.orderStatus&&(a.status="已取消")),a.lineName=g.lineName,a.orderCode=g.orderCode,a.departrueDate=FormatDateYear(g.departrueDate),a.returnDate=FormatDateYear(g.returnDate),a.guestsNum=g.guests.length,a.contactName=g.contactName,a.contactMobile=g.contactMobile,a.contactEmail=g.contactEmail,a.guests=g.guests,a.paymentAmount=g.paymentAmount;var h="../../ajax/apihandler.ashx?fn=queryrealtimerefresh&groupid="+g.groupId;b.get(h).success(function(b){return layer.close(i),0==b.payOnlineFlag?(layermyui("不允许在线支付,请到门店支付"),a.isDisabled=!0,void $(".orderbutton").attr("class","orderbutton cancel")):void 0})}),a.pay=function(){var a=getCookie("mcMemberCode");""!=a&&void 0!=a&&null!=a?window.location.href="#/app/payway/"+g+"/"+c+"/"+e+"/"+d+"/"+f:(setCookie("tolamount",amount,1),setCookie("cnum",d,1),setCookie("pnum",pnum,1),setCookie("groupid",c,1),setCookie("orderNo",g,1),window.location.href="#/app/user/login")}}]).controller("myinfoCtrl",["$scope","$http","$timeout",function(a,b,c){nofollowfunc();var d=getCookie("mcMemberCode");getCookie("fullName")?($("#myinfofullName").empty().append(getCookie("fullName")),$("#account").css({display:"block"})):$("#account").css({display:"none"}),""!==d&&void 0!==d&&null!==d&&$("#account").empty().append("退出登录"),a.seemyorder=function(){var a=getCookie("mcMemberCode");return""==a||void 0==a||null==a?void layermyui("请先登录"):void(window.location.href="#/app/user/myorder")},a.seemycoup=function(){var a=getCookie("mcMemberCode");return""==a||void 0==a||null==a?void layermyui("请先登录"):void(window.location.href="#/app/user/mycoup")},a.seemypoints=function(){var a=getCookie("mcMemberCode");return""==a||void 0==a||null==a?void layermyui("请先登录"):void(window.location.href="#/app/user/mypoints")},a.seemycollect=function(){var a=getCookie("mcMemberCode");return""==a||void 0==a||null==a?void layermyui("请先登录"):void(window.location.href="#/app/user/mycollect")},a.zx=function(){var a=getCookie("mcMemberCode");""!==a&&void 0!==a&&null!==a?layer.open({title:"提示",content:"您确定要注销吗？",btn:["嗯","不要"],yes:function(a){setCookie("mcMemberCode","",1),setCookie("fullName","",1),setCookie("phonenum","",1),$("#account").css({display:"none"}),layer.close(a),layermyui("已注销!"),$("#myinfofullName").empty().append("点击登录")}}):window.location.href="#/app/user/login"},a.seemypoints=function(){var a=getCookie("mcMemberCode");return""==a||void 0==a||null==a?void layermyui("请先登录"):void(window.location.href="#/app/user/mypoints")}}]).controller("shortregistCtrl",["$scope","$http",function(a,b){nofollowfunc(),a.checkvalidate=function(){var a=$(".checkpwd0 #phone")[0].value,c=$(".checkpwd0 #code")[0].value,d="../../ajax/userHandler.ashx?fn=checkvalidatecode4reg&phone="+a+"&code="+c,e=layer.load(1,{shade:[.5,"#ababab"]});b.get(d).success(function(a){find404admin(a),layer.close(e);var b=new X2JS,c=a,d=b.xml_str2json(c);"success"==d.validateCodeVerifyRespDto.rtcode?window.location.href="#/app/user/quickregister2":layermyui(d.validateCodeVerifyRespDto.errorMsg)})}}]).controller("quickregister2Ctrl",["$scope","$http",function(a,b){nofollowfunc(),a.regist=function(){var a=$(".quickregister #password")[0].value,c=hex_md5(a),d=hex_sha1(a),e=$(".quickregister #phone")[0].value;if(""===$(".quickregister #phone")[0].value)return void layermyui("请输入手机号");if(""===$(".quickregister #password")[0].value)return void layermyui("请输入密码");if(!checkMobile($(".quickregister #phone")[0].value))return void layermyui("手机号格式不正确");if(!isPassword($(".quickregister #password")[0].value))return void layermyui("密码过于简单,不能少于六位数");if(""===$(".quickregister #password2")[0].value)return void layermyui("请输入确认密码");if($(".quickregister #password2")[0].value!==$(".quickregister #password")[0].value)return void layermyui("两次密码不一致");var f="<webMemberDto>";f+="<email></email>",f+="<phone>"+e+"</phone>",f+="<pwd>"+c+"</pwd>",f+="<sha1pwd>"+d+"</sha1pwd>",f+="<registChannel>Website</registChannel>",f+="<registTag>IOS|JJTRAVEL_IOS_1|JinJiang</registTag>",f+="</webMemberDto>";var g="../../ajax/userHandler.ashx?fn=quickregist&xml="+f,h=layer.load(1,{shade:[.5,"#ababab"]});b.get(g).success(function(a){find404admin(a),layer.close(h);var b,c=new X2JS,d=a,f=c.xml_str2json(d);try{b=f.webMemberRegisterReturnDto.mcMemberCode}catch(g){b=""}if(""===b||void 0===b)return void layermyui(f.webMemberRegisterReturnDto.message);var i=getCookie("tolamount"),j=getCookie("cnum"),k=getCookie("pnum"),l=getCookie("groupid"),m=getCookie("secureamount");setCookie("mcMemberCode",f.webMemberRegisterReturnDto.mcMemberCode,1),setCookie("phonenum",e,1),layermyui("注册成功!将自动为您跳转..."),l>0?window.location.href="#/app/payway/"+m+"/"+l+"/"+k+"/"+j+"/"+i:window.location.href="#/app/index"})}}]).controller("mycoupCtrl",["$scope","$http","$ionicHistory",function(a,b,c){nofollowfunc();var d=getCookie("mcMemberCode"),e="../../ajax/userHandler.ashx?fn=getmembercoupinfo&Membercode="+d,f=layer.load(1,{shade:[.5,"#ababab"]});b.get(e).success(function(b){find404admin(b),layer.close(f);var c=new X2JS,d=b,e=c.xml_str2json(d);try{for(var g=0;g<e.queryAllCouponResultDto.results.length;g++)e.queryAllCouponResultDto.results[g].startDate=FormatDateYear2(e.queryAllCouponResultDto.results[g].startDate,"."),e.queryAllCouponResultDto.results[g].endDate=FormatDateYear2(e.queryAllCouponResultDto.results[g].endDate,".");a.couplist=e.queryAllCouponResultDto.results,setTimeout(function(){$(".usebox").css({display:"none"}),$(".timebox").css({display:"block"}),$(".numbox").css({display:"block"})},30),setTimeout(function(){for(var a=0;a<$(".coupbox").length;a++)$(".coupbox")[a].innerText.indexOf("￥100")>-1?$(".coupbox")[a].className="coupbox blue":$(".coupbox")[a].innerText.indexOf("￥50")>-1?$(".coupbox")[a].className="coupbox pink":$(".coupbox")[a].className="coupbox"},50)}catch(h){$(".nocoup").removeClass("displaynone")}}),a.goBackHandler=function(){window.history.back()}}]).controller("mycoupCtrl2",["$scope","$http","$ionicHistory",function(a,b,c){nofollowfunc();var d=getCookie("mcMemberCode"),e=getpbyurl(1),f=getpbyurl(2),g=getpbyurl(3),h=getpbyurl(4),i="../../ajax/userHandler.ashx?fn=getmembercouporderinfo&Membercode="+d,j=layer.load(1,{shade:[.5,"#ababab"]});b.get(i).success(function(b){find404admin(b),layer.close(j);var c=new X2JS,d=b,f=c.xml_str2json(d);try{if(f.resultDto.results.length){for(var g=0;g<f.resultDto.results.length;g++)f.resultDto.results[g].deduceAmount=f.resultDto.results[g].couponAmount;a.couplist=f.resultDto.results,setTimeout(function(){"mycoup"==e?($(".usebox").css({display:"none"}),$(".timebox").css({display:"block"}),$(".numbox").css({display:"block"})):($(".usebox").css({display:"block"}),$(".timebox").css({display:"none"}),$(".numbox").css({display:"none"}))},30),setTimeout(function(){for(var a=0;a<$(".coupbox").length;a++)$(".coupbox")[a].innerText.indexOf("￥100")>-1?$(".coupbox")[a].className="coupbox blue":$(".coupbox")[a].innerText.indexOf("￥50")>-1?$(".coupbox")[a].className="coupbox pink":$(".coupbox")[a].className="coupbox"},50)}else $(".nocoup").removeClass("displaynone")}catch(h){$(".nocoup").removeClass("displaynone")}}),a.useit=function(a){var b=$(".coupbox .deduceAmount")[a].innerHTML,c=$(".coupbox .coupcode")[a].innerHTML,d=$(".coupbox .coupname")[a].innerHTML;setCookie("coupamount",b,1),setCookie("coupcode",c,1),setCookie("coupname",d,1);var i=h-b;$(".pickresource .getcouptext")[0].innerText="-"+b,$(".pickresource .amount").empty().append(i),$(".pickresource #nextfill").attr("href","#/app/fillorder/0/"+g+"/"+f+"/"+e+"/"+i),$(".pickresource .coupamount")[0].innerText="-¥"+b,$(".pickresource #sp1")[0].children[0].children[2].disabled=!0,window.location.href="#/app/pickresource/0/"+g+"/"+f+"/"+e},a.goBackHandler=function(){window.history.back()}}]).controller("mypointsCtrl",["$scope","$http",function(a,b){nofollowfunc();var c=getCookie("mcMemberCode"),d="../../ajax/userHandler.ashx?fn=getmemberscoreinfo&Membercode="+c,e=layer.load(1,{shade:[.5,"#ababab"]});b.get(d).success(function(b){find404admin(b),layer.close(e);var c=new X2JS,d=b,f=c.xml_str2json(d);a.memberinfo=f.memberScoreLevelInfoDto}),a.seehelp=function(){layer.alert("We R family!",{icon:6})}}]).controller("mycollectCtrl",["$scope","$http",function(a,b){nofollowfunc();var c=getCookie("mcMemberCode"),d="../../ajax/apihandler.ashx?fn=getcollectlist&Membercode="+c,e=layer.load(1,{shade:[.5,"#ababab"]});b.get(d).success(function(b){layer.close(e),a.collectlist=b.ds}).error(function(a,b,c,d){layermyui("暂无收藏"),layer.close(e)}),a.listhistorygoback=function(){window.history.back()}}]);var sends2={checked:1,send:function(){function a(){return 0==d?(clearInterval(e),$(".div-phone a").addClass("send1").removeClass("send0").html("发送验证码"),sends.checked=1,!0):($(".div-phone a").html(d+"秒后再次发送"),d--,!1)}var b=/^1\d{10}$/,c=$(".forgetpwd0 #phone").val().replace(/\s+/g,"");if(0==$(".div-phone").find("span").length&&"send1 activated"==$(".div-phone a").attr("class")&&(!b.test(c)||0==c.length))return $(".div-phone").append('<span class="error">手机格式错误</span>'),!1;if(b.test(c)){var d=30;$(".div-phone span").remove(),$(".div-phone a").addClass("send0").removeClass("send1"),a();var e=setInterval(a,1e3);$.ajax({url:"../../ajax/userHandler.ashx?fn=sendvalidatecode4reg&phone="+$("#phone").val(),type:"post",success:function(a){}})}}},sends={checked:1,send:function(){function a(){return 0==d?(clearInterval(e),$(".div-phone a").addClass("send1").removeClass("send0").html("发送验证码"),sends.checked=1,!0):($(".div-phone a").html(d+"秒后再次发送"),d--,!1)}var b=/^1\d{10}$/,c=$(".checkpwd0 #phone").val().replace(/\s+/g,"");if(0==$(".div-phone").find("span").length&&"send1 activated"==$(".div-phone a").attr("class")&&(!b.test(c)||0==c.length))return $(".div-phone").append('<span class="error">手机格式错误</span>'),!1;if(b.test(c)){var d=30;$(".div-phone span").remove(),$(".div-phone a").addClass("send0").removeClass("send1"),a();var e=setInterval(a,1e3);$.ajax({url:"../../ajax/userHandler.ashx?fn=sendvalidatecode4reg&phone="+$("#phone").val(),type:"post",success:function(a){}})}}};